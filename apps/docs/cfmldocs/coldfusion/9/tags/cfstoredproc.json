{"HISTORY":"<!-- --><br>ColdFusion MX 7: Added the <samp class=\"codeph\">result<\/samp> attribute.<br>ColdFusion MX: Deprecated the <samp class=\"codeph\">connectString<\/samp>, <samp class=\"codeph\">dbName<\/samp>, <samp class=\"codeph\">dbServer<\/samp>, <samp class=\"codeph\">dbtype<\/samp>, <samp class=\"codeph\">provider<\/samp>, and <samp class=\"codeph\">providerDSN<\/samp> attributes. They do not work, and might cause an error, in releases later than ColdFusion 5. (Releases starting with ColdFusion MX use Type 4 JDBC drivers.)<br>","SYNTAX":"<!-- --><br>&lt;cfstoredproc \r\n    dataSource = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">data source name<\/i>&quot; \r\n    procedure = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">procedure name<\/i>&quot; \r\n    cachedAfter = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">date<\/i>&quot; \r\n    cachedWithin = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">time span<\/i>&quot; \r\n    debug = &quot;yes|no&quot; \r\n    blockFactor = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">block size<\/i>&quot; \r\n    password = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">password<\/i>&quot; \r\n    result = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">result name<\/i>&quot; \r\n    returnCode = &quot;yes|no&quot; \r\n    username = &quot;<i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">user name<\/i>&quot;&gt;<br><span class=\"notetitle\">Note: <\/span>You can specify this tag's attributes in an \n<samp class=\"codeph\">attributeCollection<\/samp> attribute whose value is a structure. Specify the structure name in the \n<samp class=\"codeph\">attributeCollection<\/samp> attribute and use the tag’s attribute names as structure keys.<br>","CATEGORY":"Database manipulation tags","PAGENAME":"cfstoredproc","SEEALSO":"<!-- --><br><samp class=\"codeph\"><a href=\"WSc3ff6d0ea77859461172e0811cbec22c24-7c78.html\">cfinsert<\/a><\/samp>, <samp class=\"codeph\"><a href=\"WSc3ff6d0ea77859461172e0811cbec22c24-7f6f.html\">cfqueryparam<\/a><\/samp>, <samp class=\"codeph\"><a href=\"WSc3ff6d0ea77859461172e0811cbec22c24-7d52.html\">cfprocparam<\/a><\/samp>, <samp class=\"codeph\"><a href=\"WSc3ff6d0ea77859461172e0811cbec22c24-7f95.html\">cfprocresult<\/a><\/samp>, <samp class=\"codeph\"><a href=\"WSc3ff6d0ea77859461172e0811cbec22c24-7c6b.html\">cftransaction<\/a><\/samp>, <samp class=\"codeph\"><a href=\"WSc3ff6d0ea77859461172e0811cbec22c24-7fae.html\">cfquery<\/a><\/samp>, <samp class=\"codeph\"><a href=\"WSc3ff6d0ea77859461172e0811cbec22c24-7c6a.html\">cfupdate<\/a><\/samp>; <a href=\"http:\/\/help.adobe.com\/en_US\/ColdFusion\/9.0\/Developing\/WSc3ff6d0ea77859461172e0811cbec22c24-746f.html\" target=\"_self\">Optimizing database use<\/a> in the <i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">Developing ColdFusion Applications<\/i><br>","DESCRIPTION":"Executes a stored procedure in a server database. It specifies database connection information and identifies the stored procedure.","LICENCE":"http:\/\/help.adobe.com\/en_US\/ColdFusion\/10.0\/LegalNotices\/index.html","EXAMPLE":"<!-- --><br>&lt;cfset ds = &quot;sqltst&quot;&gt; \r\n \r\n&lt;!--- \r\nIf submitting a new book, \r\ninsert the record and display \r\nconfirmation ---&gt; \r\n&lt;cfif isDefined(&quot;form.title&quot;)&gt; \r\n \r\n&lt;cfstoredproc procedure=&quot;Insert_Book&quot; datasource=&quot;#ds#&quot;&gt; \r\n \r\n&lt;cfprocparam \r\n    cfsqltype=&quot;cf_sql_varchar&quot; \r\n    value=&quot;#form.title#&quot;&gt; \r\n \r\n&lt;cfprocparam \r\n    cfsqltype=&quot;cf_sql_numeric&quot; \r\n    value=&quot;#form.price#&quot;&gt; \r\n \r\n&lt;cfprocparam \r\n    cfsqltype=&quot;cf_sql_date&quot; \r\n    value=&quot;#form.publishDate#&quot;&gt; \r\n \r\n&lt;cfprocparam \r\n    cfsqltype=&quot;cf_sql_numeric&quot; \r\n    type=&quot;out&quot; \r\n    variable=&quot;bookId&quot;&gt; \r\n \r\n&lt;\/cfstoredproc&gt; \r\n \r\n&lt;cfoutput&gt; \r\n&lt;h3&gt;'#form.title#' inserted into database.The ID is #bookId#.&lt;\/h3&gt; \r\n&lt;\/cfoutput&gt; \r\n \r\n&lt;\/cfif&gt; \r\n \r\n&lt;cfform action=&quot;#CGI.SCRIPT_NAME#&quot; method=&quot;post&quot;&gt; \r\n&lt;h3&gt;Insert a new book&lt;\/h3&gt; \r\n \r\nTitle:  \r\n&lt;cfinput type=&quot;text&quot; size=&quot;20&quot; required=&quot;yes&quot; name=&quot;title&quot;\/&gt; \r\n&lt;br\/&gt; \r\n \r\nPrice:  \r\n&lt;cfinput type=&quot;text&quot; size=&quot;20&quot; required=&quot;yes&quot; name=&quot;price&quot; validate=&quot;float&quot; \/&gt; \r\n&lt;br\/&gt; \r\n \r\nPublish Date:  \r\n&lt;cfinput type=&quot;text&quot; size=&quot;5&quot; required=&quot;yes&quot; name=&quot;publishDate&quot; validate=&quot;date&quot; \/&gt; \r\n&lt;br\/&gt; \r\n \r\n&lt;input type=&quot;submit&quot; value=&quot;Insert Book&quot;\/&gt; \r\n \r\n&lt;\/cfform&gt; \r\n \r\n&lt;!---  \r\n    This view-only example executes a Sybase stored procedure that  \r\n    returns three result sets, two of which we want. The stored  \r\n    procedure returns the status code and one output parameter,  \r\n    which we display. We use named notation for the parameters.  \r\n---&gt; \r\n&lt;!---  \r\n<strong>&lt;cfstoredproc procedure = &quot;foo_proc&quot;<\/strong> \r\n    <strong>dataSource = &quot;MY_SYBASE_TEST&quot; username = &quot;sa&quot;<\/strong> \r\n    <strong>password = &quot;&quot; dbServer = &quot;scup&quot; dbName = &quot;pubs2&quot;<\/strong> \r\n    <strong>returnCode = &quot;Yes&quot; debug = &quot;Yes&quot;&gt;<\/strong> \r\n    <strong>&lt;cfprocresult name = RS1&gt;<\/strong> \r\n    <strong>&lt;cfprocresult name = RS3 resultSet = 3&gt;<\/strong> \r\n \r\n    <strong>&lt;cfprocparam type = &quot;IN&quot; CFSQLType = CF_SQL_INTEGER<\/strong>         \r\n            <strong>value = &quot;1&quot; dbVarName = @param1&gt;<\/strong> \r\n    <strong>&lt;cfprocparam type = &quot;OUT&quot; CFSQLType = CF_SQL_DATE<\/strong> \r\n        <strong>variable = FOO dbVarName = @param2&gt;<\/strong> \r\n<strong>&lt;\/cfstoredproc&gt;<\/strong> \r\n---&gt; \r\n&lt;!---  \r\n&lt;cfoutput&gt;    The output param value: '#foo#'&lt;br&gt;&lt;\/cfoutput&gt; \r\n&lt;h3&gt;The Results Information&lt;\/h3&gt; \r\n&lt;cfoutput query = RS1&gt;#name#,#DATE_COL#&lt;br&gt;&lt;\/cfoutput&gt;&lt;p&gt; \r\n&lt;cfoutput&gt; \r\n    &lt;hr&gt; \r\n    &lt;p&gt;Record Count: #RS1.recordCount# &gt;p&gt;Columns: #RS1.columnList#    &lt;hr&gt; \r\n&lt;\/cfoutput&gt;  \r\n&lt;cfoutput query = RS3&gt;#col1#,#col2#,#col3#&lt;br&gt; \r\n&lt;\/cfoutput&gt;&lt;p&gt; \r\n&lt;cfoutput&gt; \r\n    &lt;hr&gt; \r\n    &lt;p&gt;Record Count: #RS3.recordCount# &lt;p&gt;Columns: #RS3.columnList#    &lt;hr&gt; \r\n    The return code for the stored procedure is: '#cfstoredproc.statusCode#'&lt;br&gt; \r\n&lt;\/cfoutput&gt; \r\n---&gt;<br>","USAGE":"<!-- --><br>Use this tag to call a database stored procedure. Within this tag, you code <samp class=\"codeph\"><a href=\"WSc3ff6d0ea77859461172e0811cbec22c24-7f95.html\">cfprocresult<\/a><\/samp> and <samp class=\"codeph\"><a href=\"WSc3ff6d0ea77859461172e0811cbec22c24-7d52.html\">cfprocparam<\/a><\/samp> tags as follows:<br><li><p><samp class=\"codeph\"><a href=\"WSc3ff6d0ea77859461172e0811cbec22c24-7f95.html\">cfprocresult<\/a><\/samp>: If the stored procedure returns one or more result sets, code one <samp class=\"codeph\">cfprocresult<\/samp> tag per result set.<\/p> <\/li> \n<li><p><samp class=\"codeph\"><a href=\"WSc3ff6d0ea77859461172e0811cbec22c24-7d52.html\">cfprocparam<\/a><\/samp>: If the stored procedure uses input or output parameters, code one <samp class=\"codeph\">cfprocparam<\/samp> tag per parameter, ensuring that you include every parameter in the stored procedure definition. <\/p> <\/li><br>If you set <samp class=\"codeph\">returnCode = &quot;Yes&quot;<\/samp>, this tag sets the variable <i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">prefix.<\/i><samp class=\"codeph\">statusCode<\/samp>, which holds the status code for a stored procedure. Status code values vary by DBMS. For the meaning of code values, see your DBMS documentation.<br>This tag sets the variable <i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">prefix.<\/i><samp class=\"codeph\">ExecutionTime<\/samp>, which contains the execution time of the stored procedure, in milliseconds.<br>The value of <i xmlns:fn=\"http:\/\/www.w3.org\/2005\/xpath-functions\" xmlns:fo=\"http:\/\/www.w3.org\/1999\/XSL\/Format\" xmlns:xs=\"http:\/\/www.w3.org\/2001\/XMLSchema\">prefix<\/i> is either <samp class=\"codeph\">cfstoredproc<\/samp> or the value specified by the <samp class=\"codeph\">result<\/samp> attribute, if it is set. The <samp class=\"codeph\">result<\/samp> attribute provides a way for stored procedures that are called from multiple pages, possibly at the same time, to avoid overwriting the results of one call with another. If you set the <samp class=\"codeph\">result<\/samp> attribute to <samp class=\"codeph\">myResult<\/samp>, for example, you would access <samp class=\"codeph\">ExecutionTime<\/samp> as <samp class=\"codeph\">myResult.ExecutionTime<\/samp>. Otherwise, you would access it as <samp class=\"codeph\">cfstoredproc.ExecutionTime.<\/samp><br>Before implementing this tag, ensure that you understand stored procedures and their usage.<br>The following examples use a Sybase stored procedure; for an example of an Oracle 8 or 9 stored procedure, see <samp class=\"codeph\"><a href=\"WSc3ff6d0ea77859461172e0811cbec22c24-7d52.html\">cfprocparam<\/a><\/samp>.<br>","Attribute":[{"REQOROPT":"Required","DESCRIPTION":"Name of data source that points to database that contains stored procedure.","default":" ","Attribute":"dataSource"},{"REQOROPT":"Required","DESCRIPTION":"Name of stored procedure on database server.","default":" ","Attribute":"procedure"},{"REQOROPT":"Optional","DESCRIPTION":"Maximum number of rows to get at a time from server. Range is 1 to 100.","default":1,"Attribute":"blockFactor"},{"REQOROPT":"Optional","DESCRIPTION":"A date value (for example, April 16, 2008, 4-16-2008). If the date of original query is after this date, ColdFusion uses cached query data. To use cached data, the current query must use same SQL statement, data source, query name, user name, and password. A date\/time object is in the range 100 AD–9999 AD. When specifying a date value as a string, enclose it in quotation marks.","default":" ","Attribute":"cachedAfter"},{"REQOROPT":"Optional","DESCRIPTION":"A time span, created using the CreateTimeSpan function. If the original query date falls within the time span, cached query data is used. CreateTimeSpan defines a period from the present, back. Takes effect only if query caching is enabled in the Administrator. To use cached data, the current query must use the same SQL statement, data source, query name, user name, and password.","default":" ","Attribute":"cachedWithin"},{"REQOROPT":"Optional","DESCRIPTION":"yes: lists debug information on each statement. no","default":false,"Attribute":"debug"},{"REQOROPT":"Optional","DESCRIPTION":"Overrides password in data source setup.","default":" ","Attribute":"password"},{"REQOROPT":"Optional","DESCRIPTION":"Specifies a name for the structure in which cfstoredproc returns the statusCode and ExecutionTime variables. If set, this value replaces cfstoredproc as the prefix to use when accessing those variables. For more information, see Usage.","default":" ","Attribute":"result"},{"REQOROPT":"Optional","DESCRIPTION":"yes: populates cfstoredproc.statusCode with status code returned by the stored procedure. no","default":false,"Attribute":"returnCode"},{"REQOROPT":"Optional","DESCRIPTION":"Overrides username in data source setup.","default":" ","Attribute":"username"}]}